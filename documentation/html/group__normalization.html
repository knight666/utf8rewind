<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>utf8rewind: Normalization</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">utf8rewind
   &#160;<span id="projectnumber">1.2.0</span>
   </div>
   <div id="projectbrief">Cross-platform library for UTF-8 encoded text</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Overview</span></a></li>
      <li><a href="utf8rewind_8h.html"><span>Interface</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Normalization</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gae047d522ffc5afe11b150b6d5c527b80"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__normalization.html#gae047d522ffc5afe11b150b6d5c527b80">UTF8_NORMALIZATION_RESULT_YES</a>&#160;&#160;&#160;(0)</td></tr>
<tr class="memdesc:gae047d522ffc5afe11b150b6d5c527b80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Text is stable and does not have to be normalized.  <a href="#gae047d522ffc5afe11b150b6d5c527b80">More...</a><br /></td></tr>
<tr class="separator:gae047d522ffc5afe11b150b6d5c527b80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8ea4d576e89529e074392175230dc352"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__normalization.html#ga8ea4d576e89529e074392175230dc352">UTF8_NORMALIZATION_RESULT_MAYBE</a>&#160;&#160;&#160;(1)</td></tr>
<tr class="memdesc:ga8ea4d576e89529e074392175230dc352"><td class="mdescLeft">&#160;</td><td class="mdescRight">Text is unstable, but normalization may be skipped.  <a href="#ga8ea4d576e89529e074392175230dc352">More...</a><br /></td></tr>
<tr class="separator:ga8ea4d576e89529e074392175230dc352"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9a59070cc87c6b141ab742986af0f223"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__normalization.html#ga9a59070cc87c6b141ab742986af0f223">UTF8_NORMALIZATION_RESULT_NO</a>&#160;&#160;&#160;(2)</td></tr>
<tr class="memdesc:ga9a59070cc87c6b141ab742986af0f223"><td class="mdescLeft">&#160;</td><td class="mdescRight">Text is unstable and must be normalized.  <a href="#ga9a59070cc87c6b141ab742986af0f223">More...</a><br /></td></tr>
<tr class="separator:ga9a59070cc87c6b141ab742986af0f223"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6b8ab40213f4505f96b4655fd468848d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__normalization.html#ga6b8ab40213f4505f96b4655fd468848d">UTF8_NORMALIZE_COMPOSE</a>&#160;&#160;&#160;0x00000001</td></tr>
<tr class="memdesc:ga6b8ab40213f4505f96b4655fd468848d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Normalize input to NFC.  <a href="#ga6b8ab40213f4505f96b4655fd468848d">More...</a><br /></td></tr>
<tr class="separator:ga6b8ab40213f4505f96b4655fd468848d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa9cf4bf8f49035a84de94973c9c31181"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__normalization.html#gaa9cf4bf8f49035a84de94973c9c31181">UTF8_NORMALIZE_DECOMPOSE</a>&#160;&#160;&#160;0x00000002</td></tr>
<tr class="memdesc:gaa9cf4bf8f49035a84de94973c9c31181"><td class="mdescLeft">&#160;</td><td class="mdescRight">Normalize input to NFD.  <a href="#gaa9cf4bf8f49035a84de94973c9c31181">More...</a><br /></td></tr>
<tr class="separator:gaa9cf4bf8f49035a84de94973c9c31181"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga53d4bc1347e2cb233eb212ff7160721f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__normalization.html#ga53d4bc1347e2cb233eb212ff7160721f">UTF8_NORMALIZE_COMPATIBILITY</a>&#160;&#160;&#160;0x00000004</td></tr>
<tr class="memdesc:ga53d4bc1347e2cb233eb212ff7160721f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Changes composed normalization to NFKC or decomposed normalization to NFKD.  <a href="#ga53d4bc1347e2cb233eb212ff7160721f">More...</a><br /></td></tr>
<tr class="separator:ga53d4bc1347e2cb233eb212ff7160721f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga97d390b29d670e7b7c5eea6c5a68e468"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__configuration.html#gaf8233f2b15c97ad97ccec2beff1d24a2">UTF8_API</a> uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__normalization.html#ga97d390b29d670e7b7c5eea6c5a68e468">utf8isnormalized</a> (const char *input, size_t inputSize, size_t flags, size_t *offset)</td></tr>
<tr class="memdesc:ga97d390b29d670e7b7c5eea6c5a68e468"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if a string is stable in the specified normalization form.  <a href="#ga97d390b29d670e7b7c5eea6c5a68e468">More...</a><br /></td></tr>
<tr class="separator:ga97d390b29d670e7b7c5eea6c5a68e468"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadfa0210609054db368b6af9837ca69db"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__configuration.html#gaf8233f2b15c97ad97ccec2beff1d24a2">UTF8_API</a> size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__normalization.html#gadfa0210609054db368b6af9837ca69db">utf8normalize</a> (const char *input, size_t inputSize, char *target, size_t targetSize, size_t flags, int32_t *errors)</td></tr>
<tr class="separator:gadfa0210609054db368b6af9837ca69db"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="gae047d522ffc5afe11b150b6d5c527b80"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UTF8_NORMALIZATION_RESULT_YES&#160;&#160;&#160;(0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Text is stable and does not have to be normalized. </p>

</div>
</div>
<a class="anchor" id="ga8ea4d576e89529e074392175230dc352"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UTF8_NORMALIZATION_RESULT_MAYBE&#160;&#160;&#160;(1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Text is unstable, but normalization may be skipped. </p>

</div>
</div>
<a class="anchor" id="ga9a59070cc87c6b141ab742986af0f223"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UTF8_NORMALIZATION_RESULT_NO&#160;&#160;&#160;(2)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Text is unstable and must be normalized. </p>

</div>
</div>
<a class="anchor" id="ga6b8ab40213f4505f96b4655fd468848d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UTF8_NORMALIZE_COMPOSE&#160;&#160;&#160;0x00000001</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Normalize input to NFC. </p>

</div>
</div>
<a class="anchor" id="gaa9cf4bf8f49035a84de94973c9c31181"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UTF8_NORMALIZE_DECOMPOSE&#160;&#160;&#160;0x00000002</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Normalize input to NFD. </p>

</div>
</div>
<a class="anchor" id="ga53d4bc1347e2cb233eb212ff7160721f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UTF8_NORMALIZE_COMPATIBILITY&#160;&#160;&#160;0x00000004</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Changes composed normalization to NFKC or decomposed normalization to NFKD. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga97d390b29d670e7b7c5eea6c5a68e468"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__configuration.html#gaf8233f2b15c97ad97ccec2beff1d24a2">UTF8_API</a> uint8_t utf8isnormalized </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>inputSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if a string is stable in the specified normalization form. </p>
<p>This function can be used as a preprocessing step, before attempting to normalize a string. Normalization is a very expensive process, it is often cheaper to first determine if the string is unstable in the requested normalization form.</p>
<p>Unicode Normalization Forms are formally defined normalizations of Unicode strings which make it possible to determine whether any two Unicode strings are equivalent to each other. Depending on the particular Unicode Normalization Form, that equivalence can either be a canonical equivalence or a compatibility equivalence.</p>
<p>Essentially, the Unicode Normalization Algorithm puts all combining marks in a specified order, and uses rules for decomposition and composition to transform each string into one of the Unicode Normalization Forms. A binary comparison of the transformed strings will then determine equivalence.</p>
<p>There are four Unicode Normalization Forms:</p>
<table class="doxtable">
<tr>
<th>Unicode </th><th>Flags  </th></tr>
<tr>
<td>Normalization Form C (NFC) </td><td><a class="el" href="group__normalization.html#ga6b8ab40213f4505f96b4655fd468848d" title="Normalize input to NFC. ">UTF8_NORMALIZE_COMPOSE</a> </td></tr>
<tr>
<td>Normalization Form KC (NFKC) </td><td><a class="el" href="group__normalization.html#ga6b8ab40213f4505f96b4655fd468848d" title="Normalize input to NFC. ">UTF8_NORMALIZE_COMPOSE</a> + <a class="el" href="group__normalization.html#ga53d4bc1347e2cb233eb212ff7160721f" title="Changes composed normalization to NFKC or decomposed normalization to NFKD. ">UTF8_NORMALIZE_COMPATIBILITY</a> </td></tr>
<tr>
<td>Normalization Form D (NFD) </td><td><a class="el" href="group__normalization.html#gaa9cf4bf8f49035a84de94973c9c31181" title="Normalize input to NFD. ">UTF8_NORMALIZE_DECOMPOSE</a> </td></tr>
<tr>
<td>Normalization Form KD (NFKD) </td><td><a class="el" href="group__normalization.html#gaa9cf4bf8f49035a84de94973c9c31181" title="Normalize input to NFD. ">UTF8_NORMALIZE_DECOMPOSE</a> + <a class="el" href="group__normalization.html#ga53d4bc1347e2cb233eb212ff7160721f" title="Changes composed normalization to NFKC or decomposed normalization to NFKD. ">UTF8_NORMALIZE_COMPATIBILITY</a> </td></tr>
</table>
<p>For a more detailed explanation, please see the documentation regarding normalization.</p>
<p>The result of the check will be YES if the string is stable and MAYBE or NO if it is unstable. If the result is MAYBE, the string does not necessarily have to be normalized.</p>
<p>Example:</p>
<div class="fragment"><div class="line">uint8_t Text_InspectComposed(<span class="keyword">const</span> <span class="keywordtype">char</span>* text)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* src = text;</div>
<div class="line">    <span class="keywordtype">size_t</span> src_size = strlen(text);</div>
<div class="line">    <span class="keywordtype">size_t</span> offset;</div>
<div class="line">    <span class="keywordtype">size_t</span> total_offset;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__normalization.html#ga97d390b29d670e7b7c5eea6c5a68e468">utf8isnormalized</a>(src, src_size, <a class="code" href="group__normalization.html#ga6b8ab40213f4505f96b4655fd468848d">UTF8_NORMALIZE_COMPOSE</a>, &amp;offset) == <a class="code" href="group__normalization.html#gae047d522ffc5afe11b150b6d5c527b80">UTF8_NORMALIZATION_RESULT_YES</a>)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Clean!\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    total_offset = offset;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">do</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span>* next;</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;Unstable at byte %d\n&quot;</span>, total_offset);</div>
<div class="line"></div>
<div class="line">        next = <a class="code" href="utf8rewind_8h.html#a49febdba3b3ae5ce2aa6a0464d48aa0a">utf8seek</a>(src, text, 1, SEEK_CUR);</div>
<div class="line">        <span class="keywordflow">if</span> (next == src)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        total_offset += offset;</div>
<div class="line"></div>
<div class="line">        src = next;</div>
<div class="line">        src_size -= next - src;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">while</span> (<a class="code" href="group__normalization.html#ga97d390b29d670e7b7c5eea6c5a68e468">utf8isnormalized</a>(src, src_size, <a class="code" href="group__normalization.html#ga6b8ab40213f4505f96b4655fd468848d">UTF8_NORMALIZE_COMPOSE</a>, &amp;offset) != <a class="code" href="group__normalization.html#gae047d522ffc5afe11b150b6d5c527b80">UTF8_NORMALIZATION_RESULT_YES</a>);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">input</td><td>UTF-8 encoded string. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inputSize</td><td>Size of the input in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>Desired normalization form. Must be a combination of <a class="el" href="group__normalization.html#ga6b8ab40213f4505f96b4655fd468848d" title="Normalize input to NFC. ">UTF8_NORMALIZE_COMPOSE</a>, <a class="el" href="group__normalization.html#gaa9cf4bf8f49035a84de94973c9c31181" title="Normalize input to NFD. ">UTF8_NORMALIZE_DECOMPOSE</a> and <a class="el" href="group__normalization.html#ga53d4bc1347e2cb233eb212ff7160721f" title="Changes composed normalization to NFKC or decomposed normalization to NFKD. ">UTF8_NORMALIZE_COMPATIBILITY</a> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">offset</td><td>Offset of first unstable codepoint.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__normalization.html#gae047d522ffc5afe11b150b6d5c527b80" title="Text is stable and does not have to be normalized. ">UTF8_NORMALIZATION_RESULT_YES</a></td><td>Text is stable and does not have to be normalized. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__normalization.html#ga8ea4d576e89529e074392175230dc352" title="Text is unstable, but normalization may be skipped. ">UTF8_NORMALIZATION_RESULT_MAYBE</a></td><td>Text is unstable, but normalization may be skipped. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__normalization.html#ga9a59070cc87c6b141ab742986af0f223" title="Text is unstable and must be normalized. ">UTF8_NORMALIZATION_RESULT_NO</a></td><td>Text is unstable and must be normalized. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gadfa0210609054db368b6af9837ca69db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__configuration.html#gaf8233f2b15c97ad97ccec2beff1d24a2">UTF8_API</a> size_t utf8normalize </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>inputSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>targetSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>errors</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
